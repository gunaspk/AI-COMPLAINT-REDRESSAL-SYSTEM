def handle_text_message(from_number, text, message_id):
    """Enhanced complaint management commands"""
    text_lower = text.lower().strip()
    
    # Welcome commands
    if text_lower in ["hello", "hi", "hey", "start"]:
        response = """ğŸš€ *AI-Driven Complaint Management System*

Report civic issues instantly:

ğŸ•³ï¸ *Potholes* - Road damage & safety hazards
ğŸ’¡ *Streetlights* - Broken/dim lighting issues  
ğŸ—‘ï¸ *Garbage* - Waste collection problems

*Quick Commands:*
â€¢ Type *complaint* to file issue
â€¢ Type *status* for updates
â€¢ Type *help* for options

How can I help you today?"""
        
        send_reaction(from_number, message_id, "ğŸš€")
        send_text_message(from_number, response)
    
    # File complaint
    elif text_lower == "complaint":
        response = """ğŸ“‹ *File New Complaint*

Please provide:
1ï¸âƒ£ *Photo* of the issue
2ï¸âƒ£ *Location* (share/send address)
3ï¸âƒ£ *Brief description*

*AI Auto-Detection:*
âœ… Pothole detection from images
âœ… Streetlight analysis
âœ… Garbage identification

Send your photo first! ğŸ“¸"""
        
        send_text_message(from_number, response)
    
    # Check status
    elif text_lower in ["status", "track"]:
        response = """ğŸ” *Check Complaint Status*

Send your *Complaint ID*
Format: CMP-20251005-ABC123

*Or try these:*
â€¢ *my complaints* - See all your issues
â€¢ *recent* - Last 5 complaints
â€¢ *urgent* - Priority complaints only"""
        
        send_text_message(from_number, response)
    
    # Emergency/Urgent
    elif text_lower == "urgent":
        response = """ğŸš¨ *Emergency Complaint*

For immediate attention:
â€¢ Road accident due to pothole
â€¢ Complete darkness (no streetlights)
â€¢ Health hazard garbage

Please send:
ğŸ“¸ *Photo + exact location*

Response time: *2 hours maximum*"""
        
        send_text_message(from_number, response)
    
    # Help menu
    elif text_lower == "help":
        response = """â„¹ï¸ *Help Center*

*ğŸ”¸ Commands:*
â€¢ *hello* - Welcome message
â€¢ *complaint* - File new issue
â€¢ *status* - Track complaints
â€¢ *urgent* - Emergency reports

*ğŸ”¸ Issue Types:*
â€¢ ğŸ•³ï¸ Potholes - Road damage
â€¢ ğŸ’¡ Streetlights - Lighting issues
â€¢ ğŸ—‘ï¸ Garbage - Waste problems

*ğŸ”¸ Contact:*
ğŸ“ Emergency: 108
ğŸ“§ Support: help@complaints.gov"""
        
        send_text_message(from_number, response)
    
    # Check complaint by ID
    elif text_lower.startswith("cmp-"):
        complaint_id = text.upper()
        response = f"""ğŸ“‹ *Complaint Status*

ğŸ†” ID: {complaint_id}
ğŸ“‚ Type: Pothole
ğŸ“ Area: MG Road, Bangalore
â³ Status: *In Progress*
ğŸ‘¨â€ğŸ”§ Assigned: PWD Team #247
ğŸ“… Filed: 2 days ago
ğŸ•’ ETA: 24 hours

*Updates will be sent automatically* âœ…"""
        
        send_text_message(from_number, response)
    
    # Default response
    else:
        response = f"""You said: _{text}_

*Available Commands:*
â€¢ *complaint* - File issue
â€¢ *status* - Check updates
â€¢ *help* - Full menu
â€¢ *urgent* - Emergency

Type any command to continue!"""
        
        send_text_message(from_number, response)
